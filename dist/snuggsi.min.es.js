const HTMLLinkElement=function(e){const t={},n=document.querySelector("link[href*="+e+"][rel=import]"),r=(e,t)=>HTMLImports&&!HTMLImports.useNative?HTMLImports.whenReady(e=>t({target:n})):n.addEventListener(e,t);return Object.defineProperties(t,{addEventListener:{writable:!1,value:function(e,s){n?r(e,s):s({target:t})}}}),t};class TokenList{constructor(e){this.sift(e).map(this.tokenize,this)}tokenize(e){const t=e=>t=>(this[t]=this[t]||[]).push(e);(e.text=e.textContent).match(/([^{]*?)(\w|#)(?=\})/g).map(t(e))}sift(e){const t=[],n=/{(\w+|#)}/,r=e=>e.nodeType===Node.TEXT_NODE?s(e):o(e.attributes)&&NodeFilter.FILTER_REJECT,s=e=>n.test(e.textContent)&&t.push(e),o=e=>Array.from(e).map(e=>n.test(e.value)&&t.push(e)),i=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,r);for(;i.nextNode(););return t}bind(e){const t=e=>this[e].map(t=>(t.textContent=t.text)&&e),n=(t,n="{"+t+"}")=>r=>r.textContent=r.textContent.replace(n,e[t]);Object.keys(this).map(t);for(let e in this)this[e].map(n(e))}}const HTMLTemplateElement=Template=function(e){return Object.assign(document.querySelector("template[name="+e+"]"),{bind:function(e){contexts=[].concat(...[e]);let t,n=this.cloneNode(!1);return n.innerHTML=contexts.map(e=>e).map((e,n)=>(e="object"==typeof e?e:{self:e},e["#"]=n,t=this.cloneNode(!0),new TokenList(t.content).bind(e),t.innerHTML)).join(""),(this.dependents||[]).map(e=>e.remove()),this.dependents=Array.from(n.content.childNodes),this.after(n.content),this}})},EventTarget=e=>class extends e{on(e,t){this.addEventListener(e,this.renderable(t))}renderable(e){return(t,n=!0)=>(t.prevent=(e=>(n=!1)&&t.preventDefault()))&&!1!==e.call(this,t)&&n&&this.render()}},ParentNode=e=>class extends e{selectAll(e){return this.querySelectorAll(e)}select(e){return this.selectAll(e)[0]}},GlobalEventHandlers=e=>class extends e{onconnect(e,t){(t=e.target.import)&&this.mirror(t.querySelector("template")),super.onconnect&&super.onconnect(),this.render()}reflect(e,t){(t=(e.match(/^on(.+)$/)||[])[1])&&Object.keys(HTMLElement.prototype).includes(e)&&this.on(t,this[e])}register(e){const t=(t,n)=>(n=/{\s*(\w+)\s*}/.exec(e[t]))&&(n=this[(n||[])[1]])&&(e[t]=this.renderable(n));Array.from(e.attributes).map(e=>e.name).filter(e=>/^on/.test(e)).map(t)}},Component=e=>class extends(EventTarget(ParentNode(GlobalEventHandlers(e)))){constructor(t){super();let n=Object.getOwnPropertyDescriptors(e.prototype),r=e=>"function"==typeof n[e].value&&(this[e]=this[e].bind(this));Object.keys(n).map(r),Object.getOwnPropertyNames(e.prototype).map(this.reflect,this),this.context=this.context||{},this.tokens=new TokenList(this),this.initialize&&this.initialize()}connectedCallback(){HTMLLinkElement(this.tagName.toLowerCase()).addEventListener("load",this.onconnect.bind(this))}render(){this.tokens.bind(this),Array.from(this.selectAll("template[name]")).map(e=>e.getAttribute("name")).map(e=>new Template(e).bind(this[e])),Array.from(this.selectAll("*")).concat([this]).map(this.register,this),super.onidle&&super.onidle()}mirror(e,t){e=e.cloneNode(!0),t=((t,n,r)=>(n=t.getAttribute("slot"))&&(r=e.content.querySelector("slot[name="+n+"]")).parentNode.replaceChild(t,r));for(let e of this.selectAll("[slot]"))t(e);Array.from(e.attributes).filter(e=>!this.getAttribute(e.name)).map(e=>this.setAttribute(e.name,e.value)),this.innerHTML=e.innerHTML}},ElementPrototype=window.Element.prototype,Element=e=>t=>window.customElements.define(...e,Component(t));Element.prototype=ElementPrototype;