const HTMLLinkElement=function(t){const e={},n=document.querySelector("link#"+t+"[rel=import], link[href*="+t+"][rel=import]"),o=(t,e)=>HTMLImports&&!HTMLImports.useNative?HTMLImports.whenReady(t=>e({target:n})):n.addEventListener(t,e);return Object.defineProperties(e,{addEventListener:{writable:!1,value:function(t,i){n?o(t,i):i({target:e})}}}),e};class TokenList{constructor(t){this.sift(t).map(this.tokenize,this)}tokenize(t){const e=t=>e=>(this[e]=this[e]||[]).push(t);(t.text=t.textContent).match(/([^{]*?)(\w|#)(?=\})/g).map(e(t))}sift(t){const e=[],n=/{(\w+|#)}/,o=t=>t.nodeType===Node.TEXT_NODE?i(t):r(t.attributes)&&NodeFilter.FILTER_REJECT,i=t=>n.test(t.textContent)&&e.push(t),r=t=>Array.from(t).map(t=>n.test(t.value)&&e.push(t)),s=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,o);for(;s.nextNode(););return e}bind(t){const e=t=>this[t].map(e=>(e.textContent=e.text)&&t),n=(e,n="{"+e+"}")=>o=>o.textContent=o.textContent.replace(n,t[e]);Object.keys(this).map(e);for(let t in this)this[t].map(n(t))}}const HTMLTemplateElement=Template=function(t){return Object.assign(document.querySelector("template[name="+t+"]"),{bind:function(t){contexts=[].concat(...[t]);let e,n=this.cloneNode(!1);return n.innerHTML=contexts.map(t=>t).map((t,n)=>{t="object"==typeof t?t:{self:t};t["#"]=n;e=this.cloneNode(!0);new TokenList(e.content).bind(t);return e.innerHTML}).join(""),(this.dependents||[]).map(t=>t.remove()),this.dependents=Array.from(n.content.childNodes),this.after(n.content),this}})},EventTarget=t=>class extends t{on(t,e){this.addEventListener(t,this.renderable(e))}renderable(t){return(e,n=!0)=>(e.prevent=(t=>(n=!1)&&e.preventDefault()))&&!1!==t.call(this,e)&&n&&this.render()}},ParentNode=t=>class extends t{selectAll(t){return this.querySelectorAll(t)}select(t){return this.selectAll(t)[0]}},GlobalEventHandlers=t=>class extends t{onconnect(t,e){(e=t.target.import)&&this.parse(e.querySelector("template")),super.onconnect&&super.onconnect(),this.render()}introspect(t,e){(e=(t.match(/^on(.+)$/)||[])[1])&&Object.keys(HTMLElement.prototype).includes(t)&&this.on(e,this[t])}reflect(t){const e=(e,n)=>(n=/{\s*(\w+)\s*}/.exec(t[e]))&&(n=this[(n||[])[1]])&&(t[e]=this.renderable(n));Array.from(t.attributes).map(t=>t.name).filter(t=>/^on/.test(t)).map(e)}},Component=t=>class extends(EventTarget(ParentNode(GlobalEventHandlers(t)))){constructor(){super();let e=["constructor","initialize"];Object.getOwnPropertyNames(t.prototype).filter(t=>!e.includes(t)).map(t=>console.log(t)),this.context={},this.tokens=new TokenList(this),Object.getOwnPropertyNames(t.prototype).map(this.introspect,this),this.initialize&&this.initialize()}connectedCallback(){HTMLLinkElement(this.tagName.toLowerCase()).addEventListener("load",this.onconnect.bind(this))}render(){this.tokens.bind(this),Array.from(this.selectAll("template[name]")).map(t=>t.getAttribute("name")).map(t=>new Template(t).bind(this[t])),Array.from(this.selectAll("*")).concat([this]).map(this.reflect,this),super.onidle&&super.onidle()}parse(t,e){t=t.cloneNode(!0),e=((e,n,o)=>(n=e.getAttribute("slot"))&&(o=t.content.querySelector("slot[name="+n+"]")).parentNode.replaceChild(e,o));for(let t of this.selectAll("[slot]"))e(t);Array.from(t.attributes).map(t=>this.setAttribute(t.name,t.value)),this.innerHTML=t.innerHTML}},ElementPrototype=window.Element.prototype,Element=(t,e=window.customElements)=>n=>e.define(...t,Component(n));Element.prototype=ElementPrototype;