<title>&lt;datalist-&gt;</title>

<script src=/snuggsi.es></script>
<script name=polyfill src=https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.0.0/webcomponents-hi-ce.js></script>

<link rel=stylesheet href=https://devpunks.herokuapp.com/typography.css>

<!-- import works inline body -->
<link rel=import href=/examples/header-group>

<header-group>
  <h2 slot=header>&lt;datalist-&gt;</h2>
  <a  slot=subheader title='See more component examples' href=/examples>See more component examples</a>
</header-group>

<input list=foo>

<!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/datalist -->
<datalist id=foo>

  <label>
    <select name=sex multiple>
      <!-- <option disabled selected value>Select Option -->
      <!-- https://stackoverflow.com/questions/8605516/default-select-option-as-blank#answer-23638053 -->

      <!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/option -->
      <!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/optgroup -->
      <option>Female
      <option>Male
    </select>
  </label>
</datalist>

<datalist->
  <!-- can have phrasing content - https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2 -->
  <template>
  <!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/li -->
  <li>
    <label><input value={value} type={type}>{name}</label>
  </template>
</datalist->

<script>

Element `datalist-`
// https://html.spec.whatwg.org/multipage/form-elements.html#the-datalist-element
(class extends HTMLElement {

  initialize (datalists = document.querySelectorAll `datalist`) {
    for (let datalist of datalists)
      !!! ('options' in datalist)
        && this.polyfill (datalist)
  }

  polyfill (datalist) {
    const
      select =
        datalist.querySelector `select`

    , options =
        datalist.querySelectorAll
          `option:not(:disabled)`

    , input =
        document.querySelector (`[list=${datalist.id}]`)


    // polyfill HTMLDataList.options
    datalist.hidden  = true
    datalist.options = Array.from (options)

    select.addEventListener
      ('change',
        (e, select = e.target) =>
          (input.value = select.value)
            && (select.selectedIndex = -1)
              && (datalist.hidden = true))

    input.addEventListener ('focus', e => datalist.hidden = false)
    datalist.querySelector ('select').addEventListener ('input', this.onchange)
  }
})
</script>

<script src=/browser-sync.es></script>
